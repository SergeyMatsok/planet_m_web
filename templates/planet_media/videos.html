{% extends 'base.html' %}
{% load static %}

{% block title %}–í–∏–¥–µ–æ ‚Äî –ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã{% endblock %}

{% block content %}
<h1 class="mb-4">üé¨ –í–∏–¥–µ–æ</h1>

{% if videos %}
    <div class="row">
        {% for video in videos %}
        <div class="col-md-6 mb-4">
            <div class="card h-100 bg-dark border-secondary">
                <div class="card-body">
                    <h5 class="card-title">{{ video.title }}</h5>
                    {% if video.description %}
                    <p class="card-text small text-muted mb-3">{{ video.description|truncatewords:20 }}</p>
                    {% endif %}
                    
                    <!-- –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–∏–¥–µ–æ -->
                    {% if video.video_file %}
                        <!-- –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª -->
                        <div class="ratio ratio-16x9 mb-3">
                            <video controls class="w-100" poster="{% if video.thumbnail %}{{ video.thumbnail.url }}{% endif %}">
                                <source src="{{ video.video_file.url }}" type="video/mp4">
                                –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                            </video>
                        </div>
                        <small class="text-muted">üìÅ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –Ω–∞ —Å–∞–π—Ç (MP4)</small>
                    {% elif video.youtube_url %}
                        <!-- YouTube/VK -->
                        <div class="ratio ratio-16x9 mb-3">
                            <iframe 
                                src="{{ video.get_embed_url }}" 
                                frameborder="0" 
                                allow="autoplay; encrypted-media; picture-in-picture" 
                                allowfullscreen
                                referrerpolicy="no-referrer"
                                sandbox="allow-same-origin allow-scripts allow-popups allow-forms">
                            </iframe>
                        </div>
                        {% if 'youtube' in video.youtube_url %}
                            <small class="text-muted">üì∫ YouTube</small>
                        {% elif 'vk.com' in video.youtube_url %}
                            <small class="text-muted">üì∫ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ</small>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
{% else %}
    <div class="alert alert-info">–í–∏–¥–µ–æ –ø–æ–∫–∞ –Ω–µ—Ç.</div>
{% endif %}

<a href="{% url 'home' %}" class="btn btn-outline-secondary mt-3">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
{% endblock %}